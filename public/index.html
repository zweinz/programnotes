<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Program Notes</title>

    <!-- update the version number as needed -->
    <script defer src="/__/firebase/7.6.1/firebase-app.js"></script>
    <!-- include only the Firebase features as you need -->
    <script defer src="/__/firebase/7.6.1/firebase-auth.js"></script>
    <script defer src="/__/firebase/7.6.1/firebase-database.js"></script>
    <!-- initialize the SDK after all desired features are loaded -->
    <script defer src="/__/firebase/init.js"></script>

    <style media="screen">
      body { background: black; color: white; font-family: -apple-system, Roboto, Helvetica, Arial, sans-serif; margin: 0; padding: 0; }
      a {color: white; text-decoration: underline;}
      #message { background: #121212; max-width: 360px; margin: 100px auto 16px; padding: 32px 24px; border-radius: 3px; }
      #message h2 { color: #BB86FC; font-weight: bold; font-size: 16px; margin: 0 0 8px; }
      #message h1 { font-size: 22px; font-weight: 300; color: rgba(0,0,0,0.6); margin: 0 0 16px;}
      #message p { line-height: 140%; margin: 16px 0 24px; font-size: 14px; }
      #message a.cta { display: block; text-align: center; background: #039be5; text-transform: uppercase; text-decoration: none; color: white; padding: 16px; border-radius: 4px; }
      #message, #message a { box-shadow: 0 1px 3px rgba(0,0,0,0.12), 0 1px 2px rgba(0,0,0,0.24); }
      #controlButtons { display: none;}
      #currentProgram > div {display: none;} 
      label {display: block;  padding: 8px 0;} 
      button { height: 44px; min-width: 44px; margin: 36px 8px 0; padding: 8px; background-color: #BB86FC}
      @media (max-width: 600px) {
        body, #message { margin-top: 0; background: #121212; box-shadow: none; }
        body { border-top: 16px solid #BB86FC; }
      }
      @-ms-viewport{ width: device-width; }

      input[type=checkbox] {
        width: 1em;
        height: 1em;
        background-color: white;
        border-radius: 33%;
        vertical-align: middle;
        border: 1px 4px solid #ddd;
        -webkit-appearance: none;
        outline: none;
        cursor: pointer;
        margin: 2px 4px;
      }
      input[type=checkbox]:checked {
        background-color: #3700B3;
      }

      #message ul {list-style-type: none; padding: 0;}
      #message ul li {padding: 4px; border-radius: 4px}
      #message ul li p {margin: 4px 0;}
      .highlighted {background-color: #BB86FC; color: #121212; margin: 4px 0;}
      .section {margin-top: 8px;}

      #message .note > p {border-bottom: 1px solid gray; padding-bottom: 16px; margin: 16px 0;}
      #message #note0 > p {border: 0; padding-bottom: 8px; margin: 8px;}
    </style>
  </head>
  <body>
    <div id="message">
      <h2>Zach Weiner, piano</h2>
      <div id="currentProgram">
        <div id="controlButtons">
          <button id="prevButton">Previous</button>
          <button id="nextButton">Next</button>
          <button id="resetButton">Reset</button>
        </div>

        <h3 id="movementNum"></h3>
        
        <div id="note0" class="note">
          <p>Please make sure that your phone is in do not disturb mode.</p>
          <p>Some <a target=_blank href="http://www.stephenhough.com/writings/album-notes/schubert-sonatas.php">words</a> I like from Stephen Hough's program notes: </p>

<p>SCHUBERT, in his late piano sonatas, is revealed more as a listener than a speaker, the 'heavenly length' being that open-ended time which it takes for a person to respond to the suffering of another....
</p>
<p>
 Here there is neither the superficial gloss of refinement nor the mawkish self-consciousness of profundity; rather Schubert's miraculous ability to bare his soul without a trace of narcissism - a combined result of his humility, universality, and an exquisite unawareness of either.
</p>
<p>
"Art is waiting: inspiration is waiting. Humility is a certain relation of the soul to time. It is an acceptance of waiting." â€“ Simone Weil
</p>
        </div>

        <div id="note1" class="note">
          <h3>Schubert Sonata in B-Flat Major</h3>
          <h4> I. Molto moderato</h4>
          <p>With only the gloriously ambiguous instruction to play "very moderately", this movement leaves itself open to a wide range of meaning. There are no wrong answers. Below, you may follow along with its structure and become familiar with its themes.</p>
          <ul>
            <li class="highlighted">
            Exposition: Theme 1 "Trill"
            <p>
              A pure, lyrical melody, marked by a low rumbling trill at the end, and silence. These three elements - beauty, darkness, and silence - are the foundation for the entire sonata.
            </p>
            </li>
            <li class="">Theme 1.5 "Chamber"</li>
            <li class="">Theme 2 "Dance"</li>
            <li class="section">Repeat: Theme 1 "Trill"</li>
            <li class="">Theme 1.5 "Chamber"</li>
            <li class="">Theme 2 "Dance"</li>
            <li class="section">Development</li>
            <li class="section">Recapitulation</li>
            <li class="">Coda</li>
          </ul>
        </div>

        <div id="note2" class="note">
          <h3>Schubert Sonata in B-Flat Major</h3>
          <h4> I. Molto moderato</h4>
          <ul>
            <li class="">Exposition: Theme 1 "Trill"</li>
            <li class="highlighted">Theme 1.5 "Chamber"
            <p>
              Follow the mood shifts, sometimes subtle, sometimes abrupt. Now in the distant key of F# minor, a cello in a string quartet begins a melody.
            </p>
            </li>
            <li class="">Theme 2 "Dance"</li>
            <li class="section">Repeat: Theme 1 "Trill"</li>
            <li class="">Theme 1.5 "Chamber"</li>
            <li class="">Theme 2 "Dance"</li>
            <li class="section">Development</li>
            <li class="section">Recapitulation</li>
            <li class="">Coda</li>
          </ul>
        </div>

        <div id="note3" class="note">
          <h3>Schubert Sonata in B-Flat Major</h3>
          <h4> I. Molto moderato</h4>
          <ul>
            <li class="">Exposition: Theme 1 "Trill"</li>
            <li class="">Theme 1.5 "Chamber"</li>
            <li class="highlighted">Theme 2 "Dance"
              <p>
                A lighter motive that disintegrates as it runs out of steam. These themes, once familiar, will become transformed later on.
              </p>
            </li>
            <li class="section">Repeat: Theme 1 "Trill"</li>
            <li class="">Theme 1.5 "Chamber"</li>
            <li class="">Theme 2 "Dance"</li>
            <li class="section">Development</li>
            <li class="section">Recapitulation</li>
            <li class="">Coda</li>
          </ul>
        </div>

        <div id="note4" class="note">
          <h3>Schubert Sonata in B-Flat Major</h3>
          <h4> I. Molto moderato</h4>
          <ul>
            <li class="">Exposition: Theme 1 "Trill"</li>
            <li class="">Theme 1.5 "Chamber"</li>
            <li class="">Theme 2 "Dance"</li>
            <li class="section highlighted">Repeat: Theme 1 "Trill"
              <p>
                This theme begins as a distant idea. Listen to it spin and weave until it's finally spoken out loud. This sonata was Schubert's last, and many consider it his farewell.
              </p>
              <p>
                The calm breaks off into a dark, rumbling trill in the bass. What does this evoke for you?
              </p>
              <label><input type="checkbox" name="checkbox">A distant storm over the ocean</label>
              <label><input type="checkbox" name="checkbox">A secret waiting to be told</label>
              <label><input type="checkbox" name="checkbox">The spectre of death approaching</label>
              <label><input type="checkbox" name="checkbox">A suppressed reminder of reality</label>
            </li>
            <li class="">Theme 1.5 "Chamber"</li>
            <li class="">Theme 2 "Dance"</li>
            <li class="section">Development</li>
            <li class="section">Recapitulation</li>
            <li class="">Coda</li>
          </ul>
        </div>

        <div id="note5" class="note">
          <h3>Schubert Sonata in B-Flat Major</h3>
          <h4> I. Molto moderato</h4>
          <ul>
            <li class="">Exposition: Theme 1 "Trill"</li>
            <li class="">Theme 1.5 "Chamber"</li>
            <li class="">Theme 2 "Dance"</li>
            <li class="section">Repeat: Theme 1 "Trill"</li>
            <li class="highlighted">Theme 1.5 "Chamber"
              <p>
                This is not so much a theme proper, but more of a transitory wandering in search of something more stable, unsettled between major and minor tonalities. Follow as it rises and falls over and over. What could this music be contemplating?
              </p>
              <label><input type="checkbox" name="checkbox">Waters growing murkier</label>
              <label><input type="checkbox" name="checkbox">A journey looking back in time</label>
              <label><input type="checkbox" name="checkbox">Grappling with meaning and mortality</label>
            </li>
            <li class="">Theme 2 "Dance"</li>
            <li class="section">Development</li>
            <li class="section">Recapitulation</li>
            <li class="">Coda</li>
          </ul>
        </div>

        <div id="note6" class="note">
          <h3>Schubert Sonata in B-Flat Major</h3>
          <h4> I. Molto moderato</h4>
          <ul>
            <li class="">Exposition: Theme 1 "Trill"</li>
            <li class="">Theme 1.5 "Chamber"</li>
            <li class="">Theme 2 "Dance"</li>
            <li class="section">Repeat: Theme 1 "Trill"</li>
            <li class="">Theme 1.5 "Chamber"</li>
            <li class="highlighted">Theme 2 "Dance"
              <p>
                Finally, we come to a joyful arrival. Follow it as it transforms and unravels. What could this represent?
              </p>
              <label><input type="checkbox" name="checkbox">The Platonic form of joy</label>
              <label><input type="checkbox" name="checkbox">An imagined utopia from another time</label>
              <label><input type="checkbox" name="checkbox">The dance of two people in love</label>
              <label><input type="checkbox" name="checkbox">A faÃ§ade of happiness</label>
            </li>
            <li class="section">Development</li>
            <li class="section">Recapitulation</li>
            <li class="">Coda</li>
          </ul>
        </div>

        <div id="note7" class="note">
          <h3>Schubert Sonata in B-Flat Major</h3>
          <h4> I. Molto moderato</h4>
          <ul>
            <li class="">Exposition: Theme 1 "Trill"</li>
            <li class="">Theme 1.5 "Chamber"</li>
            <li class="">Theme 2 "Dance"</li>
            <li class="section">Repeat: Theme 1 "Trill"</li>
            <li class="">Theme 1.5 "Chamber"</li>
            <li class="">Theme 2 "Dance"</li>
            <li class="section highlighted">Development
              <p>
                Our opening theme returns in the foreign key of c-sharp minor. Then, the dance enters, but the bass line takes over and Schubert tells us a story:
              </p>
              <label><input type="checkbox" name="checkbox">The storm draws near</label>
              <label><input type="checkbox" name="checkbox">A spiritual struggle with a higher power</label>
              <label><input type="checkbox" name="checkbox">The drama of a human relationship</label>
            </li>
            <li class="section">Recapitulation</li>
            <li class="">Coda</li>
          </ul>
        </div>

        <div id="note8" class="note">
          <h3>Schubert Sonata in B-Flat Major</h3>
          <h4> I. Molto moderato</h4>
          <ul>
            <li class="">Exposition: Theme 1 "Trill"</li>
            <li class="">Theme 1.5 "Chamber"</li>
            <li class="">Theme 2 "Dance"</li>
            <li class="section">Repeat: Theme 1 "Trill"</li>
            <li class="">Theme 1.5 "Chamber"</li>
            <li class="">Theme 2 "Dance"</li>
            <li class="section">Development</li>
            <li class="section highlighted">Recapitulation
              <p>
                We finally return home to the original themes, but home never feels exactly the same when returning from a journey. </p>
              <p>Schubert's music has a remarkable ability to be simultaneously personal and universal. Rather than setting the music to words, focus on the sound itself and the feelings it engenders, which transcend language.</p>
            </li>
            <li class="">Coda</li>
          </ul>
        </div>

        <div id="note9" class="note">
          <h3>Schubert Sonata in B-Flat Major</h3>
          <h4> I. Molto moderato</h4>
          <ul>
            <li class="">Exposition: Theme 1 "Trill"</li>
            <li class="">Theme 1.5 "Chamber"</li>
            <li class="">Theme 2 "Dance"</li>
            <li class="section">Repeat: Theme 1 "Trill"</li>
            <li class="">Theme 1.5 "Chamber"</li>
            <li class="">Theme 2 "Dance"</li>
            <li class="section">Development</li>
            <li class="section">Recapitulation</li>
            <li class="highlighted">Coda
              <p>The movement sputters to a close with only fragments of its theme separated with silence, struggling to hold together.</p>
            </li>
          </ul>
        </div>

        <div id="note10" class="note">
          <h3>Schubert Sonata in B-Flat Major</h3>
          <h4> II. Andante sostenuto</h4>
          <ul>
            <li class="highlighted">A section (C-sharp minor)
              <p>
                The left-hand accompaniment plays a hypnotic rising pattern, "like rowing a boat," as Fleisher says, while the right-hand melody is by turns lamenting and reaching. Perhaps the left-hand provides the "Andante" (walking) while the longer right hand notes provide the "sostenuto" (sustained).
              </p><p>
                Pianist Alfred Brendel writes, Schubert "lets himself be transported, just a hairâ€™s breadth from the abyss, not so much mastering life as being at its mercy."
              </p>
            </li>
            <li class="">B section (A Major)</li>
            <li class="">A section (C-sharp minor)</li>
          </ul>
        </div>

        <div id="note11" class="note">
          <h3>Schubert Sonata in B-Flat Major</h3>
          <h4> II. Andante sostenuto</h4>
          <ul>
            <li class="">A section (C-sharp minor)</li>
            <li class="highlighted">B section (A Major)
              <p>Silence gives way to a chorale in A Major with a persistent bass accompaniment. How do you see this music?</p>
              <label><input type="checkbox" name="checkbox">Attempted consolation</label>
              <label><input type="checkbox" name="checkbox">Peace and redemption amid tragedy</label>
              <label><input type="checkbox" name="checkbox">Angels passing overhead</label>
            </li>            
            <li class="">A section (C-sharp minor)</li>
          </ul>
        </div>

        <div id="note12" class="note">
          <h3>Schubert Sonata in B-Flat Major</h3>
          <h4> II. Andante sostenuto</h4>
          <ul>
            <li class="">A section (C-sharp minor)</li>
            <li class="">B section (A Major)</li>
            <li class="highlighted">A section (C-sharp minor)
              <p>
                After more silence, the original melody returns with a more insistent accompaniment, whose darkness is reminiscent of the opening trill. 
              </p><p>
                Words cannot do justice to the heart-stopping harmonic changes in this movement's closing, and the emotions we experience upon reaching the reluctant acceptance of its conclusion.
              </p>
            </li>
          </ul>
        </div>

        <div id="note13" class="note">
          <h3>Schubert Sonata in B-Flat Major</h3>
          <h4> III. Scherzo. Allegro vivace con delicatezza</h4>
          <ul>
            <li class="highlighted">Opening
              <p>
                "Scherzo" literally means "joke", but composers often apply this title to music of other characters. How would you describe this music?
              </p>
              <label><input type="checkbox" name="checkbox">Life goes on</label>
              <label><input type="checkbox" name="checkbox">A wistful memory of youth</label>
              <label><input type="checkbox" name="checkbox">The countryside after a storm</label>
            </li>
            <li class="">Trio</li>
            <li class="">Reprise</li>
          </ul>
        </div>

        <div id="note14" class="note">
          <h3>Schubert Sonata in B-Flat Major</h3>
          <h4> III. Scherzo. Allegro vivace con delicatezza</h4>
          <ul>
            <li class="">Opening</li>
            <li class="highlighted">Trio
              <p>
                In the middle section, Schubert is still dancing, but he peels back the surface to give a glimpse of another layer underneath.
              </p>
            </li>
            <li class="">Reprise</li>
          </ul>
        </div>

        <div id="note15" class="note">
          <h3>Schubert Sonata in B-Flat Major</h3>
          <h4> III. Scherzo. Allegro vivace con delicatezza</h4>
          <ul>
            <li class="">Opening</li>
            <li class="">Trio</li>
            <li class="highlighted">Reprise
              Schubert packs so much nuance in this short scene. Can you hear some of these?
              <label><input type="checkbox" name="checkbox">Witty surprises</label>
              <label><input type="checkbox" name="checkbox">Making a mistake and trying again</label>
              <label><input type="checkbox" name="checkbox">Call and response</label>
            </li>
          </ul>
        </div>

        <div id="note14" class="note">
          <h3>Schubert Sonata in B-Flat Major</h3>
          <h4> IV. Allegro ma non troppo</h4>
          <ul>
            <li class="highlighted">Bell</li>
            <li class="">Dance</li>
            <li class="">Storm</li>
            <li class="">Skipping</li>
            <li class="">Development</li>
            <li class="">Recapitulation</li>
          </ul>
        </div>

        <div id="note16">
          <h3>Thank you.</h3>
          If you enjoyed this performance, join my mailing list at <a class="cta" href="https://doublebarline.com/subscribe">doublebarline.com</a>
        </div>
      </div>
    </div>

    <script>
      let startingState = 0;
      class ProgramNotes {
        constructor() {
          // TODO: This is hacky, as it saves this to the database forever.
          let url = new URL(window.location.href);
          let selfControlled = url.searchParams.get("selfControlled");
          let programID = selfControlled ? "program" + Math.floor(Date.now()) : "TestProgramID";

          this.programID = programID;
          this.currentState = startingState;
          let db = firebase.database();
          this.programRef = db.ref("/programs/" + this.programID)
        }
        start() {
          this.programRef.on('value', function(snapshot) {
            let oldState = this.currentState;
            if (snapshot.exists()) {
              this.currentState = snapshot.val();
            }

            // document.getElementById("movementNum").textContent = this.currentState;
            document.getElementById("note" + oldState).style.display = "none";
            document.getElementById("note" + this.currentState).style.display = "block";
            document.getElementById("note" + this.currentState).scrollIntoView();
          }.bind(this));
        }

        // TODO: Auth for these write functions...
        increment() {
          this.programRef.set(this.currentState + 1);
        }
        decrement() {
          this.programRef.set(this.currentState - 1);
        }
        reset() {
          this.programRef.set(0); 
        }
      }


      document.addEventListener('DOMContentLoaded', function() {
        // // ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
        // // The Firebase SDK is initialized and available here!
        // // ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥

        let notes = new ProgramNotes();
        notes.start();
        document.getElementById('nextButton').onclick = function() {
          notes.increment();
        };
        document.getElementById('prevButton').onclick = function() {
          notes.decrement();
        };
        document.getElementById('resetButton').onclick = function() {
          notes.reset();
        };


        let url = new URL(window.location.href);
        let present = url.searchParams.get("present");
        if (present) {
          document.getElementById('controlButtons').style.display = 'block';
        }

        try {
          let app = firebase.app();
          let features = ['auth', 'database'].filter(feature => typeof app[feature] === 'function');
          console.log(`Firebase SDK loaded with ${features.join(', ')}`);
        } catch (e) {
          console.error(e);
          console.log('Error loading the Firebase SDK, check the console.');
        }
      });
    </script>
  </body>
</html>
